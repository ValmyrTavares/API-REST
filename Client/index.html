<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <h1>Testando a minha API rest</h1>

    <input type="text" name="title" placeholder="Titulo" value="" />
    <input type="text" name="body" placeholder="descrição" value="" />
    <input type="number" name="year" placeholder="Ano" />
    <input type="number" name="price" placeholder="Preço" />
    <button onClick="CarregandoDados()">Clique aqui</button>
    <h3>Jogos</h3>
    <div class="lista"></div>

    <script>
    //   const texto = document.querySelector("h1");
    //   texto.addEventListener("click", baixando);
      var data;
      async function baixando() {
        const dados = await fetch("http://localhost:8001/games");
        const data = await dados.json();
        const game = data.map((item) => {
          return `
                <div>
                    <p>O nome é ${item.title}<p>
                    <p>Do ano de ${item.body}<p>
                    <p>Preço: ${item.year}<p>
                    <p>Preço: ${item.price}<p>
                    <button onClick="eraser(${item.id})">Deletar</button>
                    <button onClick="edit(${item.id, item.title})">Editar</button>

                </div>                  
                                    `;
        });
        document.querySelector(".lista").innerHTML = game;
      }

      async function eraser (id, title){         
       await fetch(`http://localhost:8001/game/${id}`,
        { method:'DELETE' })
        baixando()
      }

      async function edit (id, titulo, corpo, ano, preco){  
        console.log(id)            
           
      }
     
      var input = document.querySelectorAll("input");

      function CarregandoDados() {
        let jogo = {
          title: input[0].value,
          body: input[1].value,
          year: input[2].value,
          price: input[3].value,
        };
        mandandoDados(jogo);
      }

      async function mandandoDados(jogo) {
        console.log(jogo);
        await fetch("http://localhost:8001/game", {
          method: "post",
          headers: {
            "Content-Type": "application/json; charset=utf-8",
          },
          body: JSON.stringify(jogo),
        });
        baixando()
      }
      baixando();
    </script>
  </body>
</html>
